#!/usr/bin/env bash

<%
  etcd = link("etcd")
  etcd_protocol = etcd.p("etcd.require_ssl") ? "https" : "http"
  etcd_host = "#{etcd.instances.first.address}:etcd.p('port')"

  etcd_root_username = p("etcd.root_username")
  etcd_root_password = p("etcd.root_password")

  etcd_root_uri = "#{etcd_protocol}://#{etcd_root_username}:#{etcd_root_password}@#{etcd_host}"

  default_expected_etcd_uri = "#{etcd_protocol}://#{etcd_host}"
-%>
export ETCD_USERNAME=<%= etcd_root_username %>
export ETCD_PASSWORD=<%= etcd_root_password %>
export ETCD_URI="<%= etcd_root_uri %>"

export PORT=<%= p("port") %>
export BROKER_USERNAME=<%= p("username") %>
export BROKER_PASSWORD=<%= p("password") %>
export BROKER_PUBLIC_ETCD_URL=<%= p("etcd.public_url") %>
